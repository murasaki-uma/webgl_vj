<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Simple VJ WebGL</title>
    <style>
        body { margin: 0; }
        canvas { width: 100%; height: 100% }
        #fadeInOut
        {
            width: 100%;
            height: 100%;
            position: fixed;
            top: 0;
            left: 0;
            background-color: #000;
            opacity: 0.0;
        }
    </style>
</head>
<body>
<script type="text/javascript" src="js/three.min.js"></script>
<script type="text/javascript" src="js/convex.js"></script>
<script type="text/javascript" src="js/test.js"></script>
<script type="text/javascript" src="js/box.js"></script>
<script type="text/javascript" src="js/perlin.js"></script>
<script type="text/javascript" src="js/wave.js"></script>
<script type="text/javascript" src="js/ConvexGeometry.js"></script>
<script type="text/javascript" src="js/convex.js"></script>
<script type="text/javascript" src="js/terrain.js"></script>
<script type="text/javascript" src="js/dat.gui.min.js"></script>
<script   src="https://code.jquery.com/jquery-3.1.1.min.js"   integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="   crossorigin="anonymous"></script>

<div id="fadeInOut">
</div>

<script>
    var SCENE_NUM = 0;



    (function () {

        var NUM = 0;
        var scenes= [];

        var fadeInOutTimer = -1;
        var screen;



        // シーン
        var scene,renderer,cube,camera;

        var testscene;
        init();
        render();

        function init() {
//            screen = document.getElementsByName("fadeInOut");
//            screen.style.backgroundColor = '0xffffff';




            var _scene = new Convex()
            scenes.push(_scene);

            var _scene = new FloatingBox()
            scenes.push(_scene);

//            var _scene = new ThreeJSTest()
//            scenes.push(_scene);

            var _scene = new Wave()
            scenes.push(_scene);

            var _scene = new Terrain()
            scenes.push(_scene);
            var keyname;


//            scene= new THREE.Scene();


            //testscene.animate();


// レンダラー
            renderer = new THREE.WebGLRenderer({antialias: true});
            //renderer.setPixelRatio( window.devicePixelRatio );
            renderer.setSize( window.innerWidth, window.innerHeight );
            renderer.sortObjects = false;
            renderer.shadowMap.enabled = true;
            renderer.shadowMap.type = THREE.PCFShadowMap;
            document.body.appendChild( renderer.domElement );

        }


// レンダリング
        function render() {

            //fadeInOut();
            scenes[NUM].update();
//            testscene.update();
            requestAnimationFrame(render);
            renderer.render(scenes[NUM].scene, scenes[NUM].camera);
           if(fadeInOutTimer >= 0)
           {
               fadeInOut();
           }
        }

        function fadeInOut() {
            if(fadeInOutTimer <= Math.PI*2){
                fadeInOutTimer += 0.07;
                //screen.style.opacity = Math.sin(fadeInOutTimer);
                var op = Math.sin(fadeInOutTimer);
                $("#fadeInOut")
                        .css({
                            opacity: op
                        });
            } else {

                fadeInOutTimer = -1;
                op = 0.0;
            }

            if(op > 0.95 && op <= 1.0)
            {
                switch (keyname) {
                    case 'ArrowRight':
                        console.log(scenes[NUM].END);
                        //scenes[NUM].endEnabled();
                        NUM++;
                        if(scenes.length == NUM){
                            NUM=0;
                        }
                        break;

                    case 'ArrowLeft':
                        console.log(scenes[NUM].END);
                        //scenes[NUM].endEnabled();
                        NUM--;
                        if(NUM <0){
                            NUM=scenes.length-1;
                        }
                        break;
                }
            }
        }


        window.document.onkeydown = function (event) {
            console.log(event.key);
            if(event.key == "ArrowRight" || event.key == "ArrowLeft")
            {
                keyname = event.key;
                fadeInOutTimer = 0;
            }


            //scene = new ThreeJSTest();
            //console.log(scene);
            //scene.render();
        }
    })();


</script>
</body>
</html>
